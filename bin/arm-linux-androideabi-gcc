#!/usr/bin/env python

from sys import argv
import subprocess
import os.path

we_are_linking = False
libs = []

for i, arg in enumerate(argv):
    if "-Wl,-h,libmpv.so" in arg:
        we_are_linking = True
        argv[i] = "-Wl,-h,libmpv.so"  # for android we need soname without version
    if arg.startswith("-l"):
        libs.append(arg)

argv[0] = os.path.join(os.path.dirname(os.path.realpath(__file__)), "..", "ndk-toolchain", "bin", "arm-linux-androideabi-gcc")

if we_are_linking:
    argv += libs  # duplicate the libs here to ensure all required symbols are kept

print argv

print subprocess.check_output(argv)
